大家好，今天来给大家讲下链式代理

首先给大家讲下各类节点

## 公共节点

经常在论坛或者一些电报群看到有人分享“公交车”，即公共节点

一般是快过期的机场订阅，或者是一些公益的节点，或者是一些不太稳定的节点

## 机场订阅

机场一般会做线路优化，比如建立国内中转节点，这样针对运营商优化，

让无论是电信还是联通、移动等都能有比较好的体验

有的机场会有专线，比如 IEPL 专线，速度会比较快

同时他们还会做流媒体解锁，比如 Netflix，还有 gpt 解锁等等

但机场也会有问题，比如会审查，让你某些网站无法访问

## 自建节点
一般是买一个 vps，然后自己搭建，这样可以自己控制，除了版权可能会带来审查的问题，一般不会有太多审查问题

## 链式代理
针对这些情况，我推荐是用链式代理，找一个审查少，用的人少，较为干净的节点作为落地节点，就最终访问目标网站的节点
同时用机场订阅/公交车的节点作为中转节点，找一个速度比较快的
+ 同时你访问目标网站的 IP 也不会变动得很频繁，始终用落地节点的 IP 访问目标网站，避免一些网站的风控
+ 也有一定的隐私性，机场只知道你访问了落地节点，而不知道你访问了哪个网站，也无法审查你的流量
+ 另外一个问题就是比较快的节点的 IP 是什么韩国，日本的，比如谷歌搜索出来的内容也就是韩国，日本本地化的，用链式代理就可以避免这个问题，用落地节点的 IP（比如香港、美国）访问谷歌，就不用看到韩国、日本的本地化内容

## 兼顾速度与稳定
速度肯定机场最快，机场专线都没过墙的

套一层机场，这样速度也还行，甚至说直连不通的，也可以连接了

另外一个最重要的是 Claude 这种要求一个稳定的 IP，地区

## 小火箭（shadowrocket）链式代理
shadowrocket 是一款 iOS 上的代理软件，支持链式代理，
但不是所有的类型节点都支持链式代理，比如 VMESS + GRPC 的节点就不支持

## karing 链式代理
karing 可以在分流 - 前置/链式代理中设置一个中转节点

## loon & surge 落地节点
它们落地节点不能是 hysteria2，否则会直接走落地节点，无视中转节点

## loon 链式代理
其语法是这样的：
```
[Proxy Chain]
日本代理链 = 日本场景,WARP3, udp=true
新加坡代理链 = 新国延时优选,WARP3, udp=true
香港代理链 = 香港场景,WARP3, udp=true
美国代理链 = 美国场景,WARP3, udp=true
```
比如 日本代理链 就是 日本场景通过 WARP3 连接的代理链，但这个存在一个问题，下文会讲到

## mihomo 链式代理

mihomo 使用 [dialer-proxy](https://wiki.metacubex.one/config/proxies/dialer-proxy) 参数来实现链式代理，让一个代理通过另一个代理建立连接。

### 基本配置示例

```yaml
proxies:
  # 落地节点 - 最终访问目标网站的节点
  - name: "落地节点-ss1"
    type: ss
    server: ss1.example.com
    port: 443
    cipher: aes-256-gcm
    password: "password1"
    dialer-proxy: 中转选择  # 关键：指定通过哪个代理连接

  # 中转节点
  - name: "中转节点-ss2"
    type: ss
    server: ss2.example.com
    port: 443
    cipher: aes-256-gcm
    password: "password2"

proxy-groups:
  - name: 中转选择
    type: select
    proxies:
      - 中转节点-ss2
      - DIRECT  # 也可以选择直连
```

### 工作原理

当 `落地节点-ss1` 配置了 `dialer-proxy: 中转选择` 后，数据流向为：

```
你的设备 ---> 中转节点(ss2) ==加密隧道==> 中转服务器 ---> 落地节点(ss1) ---> 目标网站
```

**效果：**
- 目标网站只看到落地节点 ss1 的 IP
- 你的运营商只看到你连接了中转节点 ss2
- 中转服务器只知道你连接了落地节点，不知道你访问了什么网站

### 批量配置（使用 proxy-provider）

如果有多个落地节点都需要走同一个中转，可以用 `override` 批量设置：

```yaml
proxy-providers:
  落地节点组:
    type: http
    url: "https://example.com/subscribe"  # 你的落地节点订阅
    interval: 3600
    override:
      dialer-proxy: 中转选择  # 给所有节点统一设置中转
    health-check:
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 300
```

### 界面测速优势

mihomo 的一大优势是界面上能对**经过中转节点后的落地节点**进行测速，显示的是整个链路的真实延迟。

这一点 surge 也能很直观的看到，被代理后的节点的延迟

## loon 链式代理 与 surge/mihomo 的区别

而 loon 就比较麻烦了，不能直观的看到被代理后的节点的延迟

举例比如三个落地节点 A B C, 其中 B 直接连接不通，但通过中转节点可以访问，

surge/mihomo分别使用 underlying-proxy/dialer-proxy 可以代理后 B 的延迟

但 loon 就不能这样看，必须是选中 B 后，然后才能看整个代理链的延迟


## Quantumult-x 链式代理

配置十分麻烦（逆天）我估计界面上看延迟也不直观 不想研究了

https://github.com/crossutility/Quantumult-X/issues/100#issuecomment-2117173209


## 视频讲解：

[![视频讲解](https://img.youtube.com/vi/-YVwGnSmvuQ/0.jpg)](https://www.youtube.com/watch?v=-YVwGnSmvuQ)
